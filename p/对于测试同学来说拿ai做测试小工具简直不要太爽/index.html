<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="å‰å› åæœ æœ€è¿‘æœ‰ä¸€äº›åšæµ‹è¯•ä½¿ç”¨çš„å°å·¥å…·çš„éœ€æ±‚ï¼Œæ‹¿ AI ç”Ÿæˆäº†ä¸€ä¸‹ï¼Œå‘ç°ç¡®å®å¯¹æµ‹è¯•æ•ˆç‡æœ‰ä¸€å®šçš„æå‡ã€‚\nå‰å‡ å¤©éœ€è¦å†™ä¸€ä¸ªç®€å•çš„æ€§èƒ½å‹æµ‹å·¥å…·ï¼Œè‡ªå·±å†™çš„è¯å¯èƒ½è¦ 1-2 å¤©ï¼Œä¼°è®¡æ•ˆæœè¿˜ä¸å¤ªå¥½ï¼Œäºæ˜¯è¯•ç€æ‹¿ AI å»ç”Ÿæˆäº†ä¸€ä¸‹ã€‚\n"><title>å¯¹äºæµ‹è¯•åŒå­¦æ¥è¯´ï¼Œæ‹¿AIåšæµ‹è¯•å°å·¥å…·ç®€ç›´ä¸è¦å¤ªçˆ½</title><link rel=canonical href=zh.ethanhan.cc/p/%E5%AF%B9%E4%BA%8E%E6%B5%8B%E8%AF%95%E5%90%8C%E5%AD%A6%E6%9D%A5%E8%AF%B4%E6%8B%BFai%E5%81%9A%E6%B5%8B%E8%AF%95%E5%B0%8F%E5%B7%A5%E5%85%B7%E7%AE%80%E7%9B%B4%E4%B8%8D%E8%A6%81%E5%A4%AA%E7%88%BD/><link rel=stylesheet href=zh.ethanhan.cc/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="å¯¹äºæµ‹è¯•åŒå­¦æ¥è¯´ï¼Œæ‹¿AIåšæµ‹è¯•å°å·¥å…·ç®€ç›´ä¸è¦å¤ªçˆ½"><meta property='og:description' content="å‰å› åæœ æœ€è¿‘æœ‰ä¸€äº›åšæµ‹è¯•ä½¿ç”¨çš„å°å·¥å…·çš„éœ€æ±‚ï¼Œæ‹¿ AI ç”Ÿæˆäº†ä¸€ä¸‹ï¼Œå‘ç°ç¡®å®å¯¹æµ‹è¯•æ•ˆç‡æœ‰ä¸€å®šçš„æå‡ã€‚\nå‰å‡ å¤©éœ€è¦å†™ä¸€ä¸ªç®€å•çš„æ€§èƒ½å‹æµ‹å·¥å…·ï¼Œè‡ªå·±å†™çš„è¯å¯èƒ½è¦ 1-2 å¤©ï¼Œä¼°è®¡æ•ˆæœè¿˜ä¸å¤ªå¥½ï¼Œäºæ˜¯è¯•ç€æ‹¿ AI å»ç”Ÿæˆäº†ä¸€ä¸‹ã€‚\n"><meta property='og:url' content='zh.ethanhan.cc/p/%E5%AF%B9%E4%BA%8E%E6%B5%8B%E8%AF%95%E5%90%8C%E5%AD%A6%E6%9D%A5%E8%AF%B4%E6%8B%BFai%E5%81%9A%E6%B5%8B%E8%AF%95%E5%B0%8F%E5%B7%A5%E5%85%B7%E7%AE%80%E7%9B%B4%E4%B8%8D%E8%A6%81%E5%A4%AA%E7%88%BD/'><meta property='og:site_name' content='ä¹™é†‡çš„åšå®¢'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2025-08-28T17:33:25+08:00'><meta property='article:modified_time' content='2025-08-28T17:33:25+08:00'><meta name=twitter:title content="å¯¹äºæµ‹è¯•åŒå­¦æ¥è¯´ï¼Œæ‹¿AIåšæµ‹è¯•å°å·¥å…·ç®€ç›´ä¸è¦å¤ªçˆ½"><meta name=twitter:description content="å‰å› åæœ æœ€è¿‘æœ‰ä¸€äº›åšæµ‹è¯•ä½¿ç”¨çš„å°å·¥å…·çš„éœ€æ±‚ï¼Œæ‹¿ AI ç”Ÿæˆäº†ä¸€ä¸‹ï¼Œå‘ç°ç¡®å®å¯¹æµ‹è¯•æ•ˆç‡æœ‰ä¸€å®šçš„æå‡ã€‚\nå‰å‡ å¤©éœ€è¦å†™ä¸€ä¸ªç®€å•çš„æ€§èƒ½å‹æµ‹å·¥å…·ï¼Œè‡ªå·±å†™çš„è¯å¯èƒ½è¦ 1-2 å¤©ï¼Œä¼°è®¡æ•ˆæœè¿˜ä¸å¤ªå¥½ï¼Œäºæ˜¯è¯•ç€æ‹¿ AI å»ç”Ÿæˆäº†ä¸€ä¸‹ã€‚\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/zh.ethanhan.cc/><img src=zh.ethanhan.cc/img/avatar_hu_c3223959809ae462.jpg width=300 height=169 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ˜Š</span></figure><div class=site-meta><h1 class=site-name><a href=/zh.ethanhan.cc>ä¹™é†‡çš„åšå®¢</a></h1><h2 class=site-description>èµ°å‡ºèˆ’é€‚åŒº</h2></div></header><ol class=menu-social><li><a href=https://github.com/easonhan007/blogzh2025 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=zh.ethanhan.cc/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=zh.ethanhan.cc/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=zh.ethanhan.cc/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=zh.ethanhan.cc/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>å‹æƒ…é“¾æ¥</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#å‰å› åæœ>å‰å› åæœ</a></li><li><a href=#å…·ä½“è¿‡ç¨‹>å…·ä½“è¿‡ç¨‹</a></li><li><a href=#æ¨ªå‘æ¯”è¾ƒ>æ¨ªå‘æ¯”è¾ƒ</a></li><li><a href=#æ€è€ƒ>æ€è€ƒ</a></li><li><a href=#å­¦ä¹ æ—¶é—´>å­¦ä¹ æ—¶é—´</a><ol><li><a href=#å‡½æ•°ç­¾åè§£æ>å‡½æ•°ç­¾åè§£æ</a></li><li><a href=#é€æ­¥è¯¦ç»†è§£æ>é€æ­¥è¯¦ç»†è§£æ</a><ol><li><a href=#1-è§£æå’Œé…ç½®é˜¶æ®µ>1. è§£æå’Œé…ç½®é˜¶æ®µ</a></li><li><a href=#2-è¿›åº¦æ¡è®¾ç½®>2. è¿›åº¦æ¡è®¾ç½®</a></li><li><a href=#3-å·¥ä½œçº¿ç¨‹åˆ›å»ºå…³é”®éƒ¨åˆ†>3. å·¥ä½œçº¿ç¨‹åˆ›å»ºï¼ˆå…³é”®éƒ¨åˆ†ï¼‰</a></li><li><a href=#4-æ—¶é—´æ§åˆ¶å’Œæ¸…ç†>4. æ—¶é—´æ§åˆ¶å’Œæ¸…ç†</a></li><li><a href=#5-ç»“æœæ”¶é›†å’Œè¾“å‡º>5. ç»“æœæ”¶é›†å’Œè¾“å‡º</a></li></ol></li><li><a href=#å¹¶å‘æ‰§è¡Œæµç¨‹å›¾>å¹¶å‘æ‰§è¡Œæµç¨‹å›¾</a></li><li><a href=#å†…å­˜å®‰å…¨å’Œå¹¶å‘å®‰å…¨>å†…å­˜å®‰å…¨å’Œå¹¶å‘å®‰å…¨</a><ol><li><a href=#rust-çš„ä¼˜åŠ¿>Rust çš„ä¼˜åŠ¿ï¼š</a></li><li><a href=#å¯¹æ¯”å…¶ä»–è¯­è¨€å¯èƒ½çš„é—®é¢˜>å¯¹æ¯”å…¶ä»–è¯­è¨€å¯èƒ½çš„é—®é¢˜ï¼š</a></li></ol></li><li><a href=#é”™è¯¯å¤„ç†>é”™è¯¯å¤„ç†</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=zh.ethanhan.cc/p/%E5%AF%B9%E4%BA%8E%E6%B5%8B%E8%AF%95%E5%90%8C%E5%AD%A6%E6%9D%A5%E8%AF%B4%E6%8B%BFai%E5%81%9A%E6%B5%8B%E8%AF%95%E5%B0%8F%E5%B7%A5%E5%85%B7%E7%AE%80%E7%9B%B4%E4%B8%8D%E8%A6%81%E5%A4%AA%E7%88%BD/>å¯¹äºæµ‹è¯•åŒå­¦æ¥è¯´ï¼Œæ‹¿AIåšæµ‹è¯•å°å·¥å…·ç®€ç›´ä¸è¦å¤ªçˆ½</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-08-28T17:33:25+08:00>Aug 28, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 6 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h2 id=å‰å› åæœ>å‰å› åæœ</h2><p>æœ€è¿‘æœ‰ä¸€äº›åšæµ‹è¯•ä½¿ç”¨çš„å°å·¥å…·çš„éœ€æ±‚ï¼Œæ‹¿ AI ç”Ÿæˆäº†ä¸€ä¸‹ï¼Œå‘ç°ç¡®å®å¯¹æµ‹è¯•æ•ˆç‡æœ‰ä¸€å®šçš„æå‡ã€‚</p><p>å‰å‡ å¤©éœ€è¦å†™ä¸€ä¸ªç®€å•çš„æ€§èƒ½å‹æµ‹å·¥å…·ï¼Œè‡ªå·±å†™çš„è¯å¯èƒ½è¦ 1-2 å¤©ï¼Œä¼°è®¡æ•ˆæœè¿˜ä¸å¤ªå¥½ï¼Œäºæ˜¯è¯•ç€æ‹¿ AI å»ç”Ÿæˆäº†ä¸€ä¸‹ã€‚</p><p>ä¸ºäº†è®©å·¥å…·æœ‰è¶³å¤Ÿçš„å¹¶å‘æ€§èƒ½ï¼Œæˆ‘é€‰æ‹©ç”¨ rust è¯­è¨€æ¥å®ç°ã€‚</p><p>ç®€å•æè¿°äº†ä¸€ä¸‹éœ€æ±‚ï¼Œclaude å°±åœ¨å‡ åˆ†é’Ÿä¹‹å†…ç»™å‡ºäº†ç»“æœã€‚</p><h2 id=å…·ä½“è¿‡ç¨‹>å…·ä½“è¿‡ç¨‹</h2><p>æˆ‘çš„æç¤ºè¯éå¸¸ç®€å•</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>How to use rust to implement this cli feature .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>it is a stress test cli
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>apistress rest --url https://api.example.com/users \
</span></span><span class=line><span class=cl>               --method POST \
</span></span><span class=line><span class=cl>               --body &#39;{&#34;name&#34;:&#34;test&#34;}&#39; \
</span></span><span class=line><span class=cl>               --header &#34;Authorization: Bearer TOKEN&#34; \
</span></span><span class=line><span class=cl>               --concurrency 50 \
</span></span><span class=line><span class=cl>               --duration 30s \
</span></span><span class=line><span class=cl>               --rate 1000 \
</span></span><span class=line><span class=cl>               --output json
</span></span></code></pre></td></tr></table></div></div><p>ä¸ä¹… claude ç»™å‡ºäº†ç¬¬ä¸€ç‰ˆçš„ä»£ç ã€‚</p><p>åˆç‰ˆçš„ä»£ç é‡Œæ‰€æœ‰çš„å†…å®¹éƒ½å†™åœ¨<code>main.rs</code>é‡Œé¢ï¼Œå°½ç®¡ç®€å•ï¼Œä½†å¯ç»´æŠ¤æ€§è¿˜æ˜¯ä¸å¼ºã€‚</p><p>äºæ˜¯æˆ‘å†åŠ å¼ºäº†ä¸€ä¸‹ã€‚</p><p>è¿™æ˜¯æˆ‘çš„æç¤ºè¯ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>seperate to more files
</span></span></code></pre></td></tr></table></div></div><p>å‘Šè¯‰ ai å°†ä»£ç åˆ†æˆå¤šä¸ªæ–‡ä»¶ã€‚</p><p>è¿™æ˜¯åæ¥çš„æ–‡ä»¶ç›®å½•ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zed data-lang=zed><span class=line><span class=cl><span class=nn>src/</span><span class=n>main</span><span class=p>.</span><span class=n>rs</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>Entry</span><span class=w> </span><span class=n>point</span><span class=w> </span><span class=n>that</span><span class=w> </span><span class=n>sets</span><span class=w> </span><span class=n>up</span><span class=w> </span><span class=n>modules</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>runs</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>CLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>src/</span><span class=n>cli</span><span class=p>.</span><span class=n>rs</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>Command</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=n>interface</span><span class=w> </span><span class=kt>definition</span><span class=w> </span><span class=n>using</span><span class=w> </span><span class=n>clap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>src/</span><span class=n>config</span><span class=p>.</span><span class=n>rs</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>Request</span><span class=w> </span><span class=n>configuration</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>parsing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>src/</span><span class=n>client</span><span class=p>.</span><span class=n>rs</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>HTTP</span><span class=w> </span><span class=n>client</span><span class=w> </span><span class=n>functionality</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>src/</span><span class=n>results</span><span class=p>.</span><span class=n>rs</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>Test</span><span class=w> </span><span class=n>results</span><span class=w> </span><span class=n>and</span><span class=w> </span><span class=n>reporting</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>src/</span><span class=n>rate_limiter</span><span class=p>.</span><span class=n>rs</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>Rate</span><span class=w> </span><span class=n>limiting</span><span class=w> </span><span class=n>implementation</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>src/</span><span class=n>stress_test</span><span class=p>.</span><span class=n>rs</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>Main</span><span class=w> </span><span class=n>stress</span><span class=w> </span><span class=n>testing</span><span class=w> </span><span class=n>orchestration</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>é€»è¾‘ä¸Šæ¸…æ¥šå¤šäº†ã€‚</p><p>æ ¹æ®ä»£ç ç¼–è¯‘äº†ä¸€ä¸‹ï¼Œç„¶åéšæ‰‹å†™äº†ä¸ª api è¯•è¯•æ•ˆæœã€‚</p><p>api åº”ç”¨æ˜¯ç”¨ golang+gin å»å†™çš„ï¼Œä»£ç éå¸¸ç®€å•ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-golang data-lang=golang><span class=line><span class=cl><span class=w>	</span><span class=nx>r</span><span class=p>.</span><span class=nf>GET</span><span class=p>(</span><span class=s>&#34;/ping&#34;</span><span class=p>,</span><span class=w> </span><span class=kd>func</span><span class=p>(</span><span class=nx>c</span><span class=w> </span><span class=o>*</span><span class=nx>gin</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=nx>c</span><span class=p>.</span><span class=nf>JSON</span><span class=p>(</span><span class=nx>http</span><span class=p>.</span><span class=nx>StatusOK</span><span class=p>,</span><span class=w> </span><span class=nx>gin</span><span class=p>.</span><span class=nx>H</span><span class=p>{</span><span class=s>&#34;message&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;pong&#34;</span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>})</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>æ‹¿ ai ç”Ÿæˆçš„å·¥å…·å»è¯•è¯•æ•ˆæœã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>stress_test rest --url http://localhost:8080/ping --duration 10s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[00:00:10] Test completed
</span></span><span class=line><span class=cl>=== Stress Test Results ===
</span></span><span class=line><span class=cl>Total Requests: 273398
</span></span><span class=line><span class=cl>Successful: 273398
</span></span><span class=line><span class=cl>Failed: 0
</span></span><span class=line><span class=cl>Test Duration: 10.00s
</span></span><span class=line><span class=cl>Requests/sec: 27339.80
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Latency:
</span></span><span class=line><span class=cl>  Min: 0.06ms
</span></span><span class=line><span class=cl>  Max: 33.02ms
</span></span><span class=line><span class=cl>  Avg: 0.31ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Status Codes:
</span></span><span class=line><span class=cl>  200: 273398
</span></span></code></pre></td></tr></table></div></div><p>ç»“æœæ˜¯æŒºæƒŠè‰³çš„ï¼Œè·‘å‡ºäº† 27k çš„ QPSï¼Œæ€§èƒ½æ–¹é¢åº”è¯¥æ˜¯æ»¡è¶³æˆ‘çš„åŸå§‹éœ€æ±‚çš„ã€‚</p><h2 id=æ¨ªå‘æ¯”è¾ƒ>æ¨ªå‘æ¯”è¾ƒ</h2><p>ä¸ºäº†æ¨ªå‘æ¯”è¾ƒè¿™ä¸ªå·¥å…·çš„æ€§èƒ½ï¼Œæˆ‘åˆç”¨ golang å†™äº†ä¸ªç±»ä¼¼åŠŸèƒ½çš„ cli å‹åŠ›æµ‹è¯•å·¥å…·ã€‚</p><p>ç”¨åŒæ ·çš„è¢«æµ‹åº”ç”¨è·‘äº†ä¸€ä¸‹æ•ˆæœã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>â  Running stress test...  [9s]
</span></span><span class=line><span class=cl>=== Stress Test Results ===
</span></span><span class=line><span class=cl>Total Requests: 29244
</span></span><span class=line><span class=cl>Successful: 29244
</span></span><span class=line><span class=cl>Failed: 0
</span></span><span class=line><span class=cl>Test Duration: 10.00s
</span></span><span class=line><span class=cl>Requests/sec: 2924.40
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Latency:
</span></span><span class=line><span class=cl>  Min: 0.18ms
</span></span><span class=line><span class=cl>  Max: 614.15ms
</span></span><span class=line><span class=cl>  Avg: 3.41ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Status Codes:
</span></span><span class=line><span class=cl>  200: 29244
</span></span></code></pre></td></tr></table></div></div><p>åªè·‘å‡ºäº† 2.9k çš„ QPSï¼ŒåŸºæœ¬ä¸Šæ€§èƒ½å·®äº† 10 å€ã€‚</p><h2 id=æ€è€ƒ>æ€è€ƒ</h2><ul><li>AI çš„ç¼–ç¨‹èƒ½åŠ›å·²ç»è¶…è¿‡äº†æˆ‘èƒ½åŠ›ï¼Œæˆ‘ç»å°½è„‘æ±å†™çš„å·¥å…·åœ¨æ€§èƒ½ä¸Šæ˜¯å®Œå…¨æ¯”ä¸ä¸Š ai å‡ åˆ†é’Ÿç”Ÿæˆçš„ç»“æœçš„</li><li>Golang çš„æ€§èƒ½æ¯” Rust è¦å·®ï¼Œä½†åœ¨å¹¶å‘ä¸Šæ•ˆæœå·® 10 å€ï¼Œè¿™æ˜¯ä¸æ­£å¸¸çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯å°è¯äº†ä¸Šé¢çš„è§‚ç‚¹ï¼Œai çš„ä»£ç å†™çš„æ›´åˆç†ï¼Œæ¯”æˆ‘è¦å¼º</li></ul><p>å¯¹äºæµ‹è¯•åŒå­¦æ¥è¯´ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå†™ä¸€äº›æ¬¡æŠ›çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·å¯èƒ½åœ¨æŸäº›æµ‹è¯•ä»»åŠ¡ä¸Šä¼šç»™æˆ‘ä»¬å¸¦æ¥æå¤§çš„æ•ˆç‡æå‡ï¼Œæ¯”å¦‚é€ æ•°æ®å·¥å…·ã€‚</p><p>ä½†æ˜¯æµ‹è¯•åŒå­¦çš„ä»£ç èƒ½åŠ›æœ‰é™ï¼Œæ—¶é—´æœ‰é™ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯ä¸ä¼šå»å†™è¿™äº›æ¬¡æŠ›å·¥å…·çš„ã€‚</p><p>è¿™å°±é€ æˆäº†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€‰æ‹©ç”¨äººå·¥çš„æ–¹å¼å»å®Œæˆè¿™äº›é‡å¤æ€§çš„å·¥å…·ã€‚</p><p>è¿™å°±æ˜¯æˆ‘ä»¬æµ‹è¯•ç»å¸¸è¢«è¯Ÿç—…æµ‹è¯•æ•ˆç‡ä½ä¸‹çš„ä¸€éƒ¨åˆ†åŸå› äº†ã€‚</p><p>ç°åœ¨æœ‰äº† aiï¼Œæµ‹è¯•åŒå­¦å“ªæ€•ä¸ä¼šå†™ä»£ç ï¼Œä¹Ÿå®Œå…¨æœ‰èƒ½åŠ›æŠŠè‡ªå·±çš„æ¬¡æŠ›å·¥å…·éœ€æ±‚ç»™æè¿°æ¸…æ¥šï¼Œæ¯•ç«Ÿæ˜¯ä¸€æ¬¡æ€§æˆ–è€…å‡ æ¬¡æ€§çš„å·¥å…·ï¼ŒåŠŸèƒ½å¤§éƒ½ä¸å¤æ‚ï¼Œå¯¹ ai éå¸¸å‹å¥½ï¼Œæ‰€ä»¥å‡ ä¸ªæ¥å›å°±å¯ä»¥æŠŠå·¥å…·ç»™ç”Ÿæˆå‡ºæ¥ã€‚</p><p>å¯ä»¥é¢„æƒ³åˆ°ï¼Œåœ¨ä¸è¿œçš„å°†æ¥ï¼Œæµ‹è¯•å²—ä½å¯èƒ½ä¼šæœ‰å‡å°‘ï¼Œä½†ç†Ÿç»ƒä½¿ç”¨ ai å¹¶è·Ÿæµ‹è¯•ç»“åˆçš„æ–°å‹æµ‹è¯•äººæ‰ï¼Œåº”è¯¥æ˜¯ä¼šæœ‰ä¸€å®šçš„å¸‚åœºçš„ã€‚</p><p>æ‰€ä»¥ä»æœ¬è´¨ä¸Šè®²ï¼Œä»Šåçš„ä¸€æ®µæ—¶é—´ï¼Œå‘ç°é—®é¢˜è¿˜æ˜¯é äººï¼Œä½†æ˜¯ ai ä¼šåŠ é€Ÿè¿™ä¸ªè¿‡ç¨‹ã€‚</p><h2 id=å­¦ä¹ æ—¶é—´>å­¦ä¹ æ—¶é—´</h2><p>æ˜¯æ—¶å€™çœ‹ä¸€ä¸‹è¿™ä¸ªæµ‹è¯•å·¥å…·ä¸­çš„æ ¸å¿ƒä»£ç äº†ï¼Œè¿˜æ˜¯éå¸¸æœ‰å­¦ä¹ çš„æ„ä¹‰çš„ã€‚</p><p>Rust ç‰ˆæœ¬çš„å‹åŠ›æµ‹è¯•æ ¸å¿ƒå‡½æ•°ï¼š</p><h3 id=å‡½æ•°ç­¾åè§£æ>å‡½æ•°ç­¾åè§£æ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>pub</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=k>fn</span> <span class=nf>run_stress_test</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>url</span>: <span class=nb>String</span><span class=p>,</span><span class=w>                    </span><span class=c1>// ç›®æ ‡URL
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>method</span>: <span class=nb>String</span><span class=p>,</span><span class=w>                 </span><span class=c1>// HTTPæ–¹æ³• (GET, POST, etc.)
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>body</span>: <span class=nb>Option</span><span class=o>&lt;</span><span class=nb>String</span><span class=o>&gt;</span><span class=p>,</span><span class=w>           </span><span class=c1>// å¯é€‰çš„è¯·æ±‚ä½“
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>headers</span>: <span class=nb>Vec</span><span class=o>&lt;</span><span class=nb>String</span><span class=o>&gt;</span><span class=p>,</span><span class=w>           </span><span class=c1>// è¯·æ±‚å¤´åˆ—è¡¨
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>concurrency</span>: <span class=kt>usize</span><span class=p>,</span><span class=w>             </span><span class=c1>// å¹¶å‘æ•°
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>duration</span>: <span class=nb>String</span><span class=p>,</span><span class=w>               </span><span class=c1>// æµ‹è¯•æŒç»­æ—¶é—´å­—ç¬¦ä¸²
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>rate</span>: <span class=nb>Option</span><span class=o>&lt;</span><span class=kt>u64</span><span class=o>&gt;</span><span class=p>,</span><span class=w>              </span><span class=c1>// å¯é€‰çš„é€Ÿç‡é™åˆ¶
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>output</span>: <span class=nc>OutputFormat</span><span class=p>,</span><span class=w>           </span><span class=c1>// è¾“å‡ºæ ¼å¼
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w> </span>-&gt; <span class=nb>Result</span><span class=o>&lt;</span><span class=p>()</span><span class=o>&gt;</span><span class=w>                     </span><span class=c1>// è¿”å›Resultç±»å‹
</span></span></span></code></pre></td></tr></table></div></div><h3 id=é€æ­¥è¯¦ç»†è§£æ>é€æ­¥è¯¦ç»†è§£æ</h3><h4 id=1-è§£æå’Œé…ç½®é˜¶æ®µ>1. è§£æå’Œé…ç½®é˜¶æ®µ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=c1>// è§£ææŒç»­æ—¶é—´å­—ç¬¦ä¸² &#34;30s&#34; -&gt; Durationå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>test_duration</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>humantime</span>::<span class=n>parse_duration</span><span class=p>(</span><span class=o>&amp;</span><span class=n>duration</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>// åˆ›å»ºè¯·æ±‚é…ç½®å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰HTTPè¯·æ±‚å‚æ•°
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestConfig</span>::<span class=n>new</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=w> </span><span class=n>method</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>,</span><span class=w> </span><span class=n>headers</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>// åˆ›å»ºHTTPå®¢æˆ·ç«¯ï¼ˆå¤ç”¨è¿æ¥æ± ï¼‰
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Client</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>// åˆ›å»ºå…±äº«çš„æµ‹è¯•ç»“æœå¯¹è±¡
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>results</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Arc</span>::<span class=n>new</span><span class=p>(</span><span class=n>Mutex</span>::<span class=n>new</span><span class=p>(</span><span class=n>TestResult</span>::<span class=n>new</span><span class=p>()));</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>ä¸ºä»€ä¹ˆç”¨ <code>Arc&lt;Mutex&lt;T>></code>ï¼Ÿ</strong></p><ul><li><code>Arc</code>ï¼šåŸå­å¼•ç”¨è®¡æ•°ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥å®‰å…¨åœ°å…±äº«æ‰€æœ‰æƒ</li><li><code>Mutex</code>ï¼šäº’æ–¥é”ï¼Œç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½ä¿®æ”¹ç»“æœ</li></ul><h4 id=2-è¿›åº¦æ¡è®¾ç½®>2. è¿›åº¦æ¡è®¾ç½®</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>pb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>create_progress_bar</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>pb</span><span class=p>.</span><span class=n>set_message</span><span class=p>(</span><span class=s>&#34;Running stress test...&#34;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>ç”¨æˆ·å¯ä»¥çœ‹åˆ°æµ‹è¯•æ­£åœ¨è¿›è¡Œä¸­çš„å®æ—¶åé¦ˆã€‚</p><h4 id=3-å·¥ä½œçº¿ç¨‹åˆ›å»ºå…³é”®éƒ¨åˆ†>3. å·¥ä½œçº¿ç¨‹åˆ›å»ºï¼ˆå…³é”®éƒ¨åˆ†ï¼‰</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>handles</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Vec</span>::<span class=n>new</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>for</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>0</span><span class=o>..</span><span class=n>concurrency</span><span class=w> </span><span class=p>{</span><span class=w>  </span><span class=c1>// åˆ›å»ºæŒ‡å®šæ•°é‡çš„å¹¶å‘å·¥ä½œè€…
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ä¸ºæ¯ä¸ªå·¥ä½œè€…å…‹éš†å¿…è¦çš„èµ„æº
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>client</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>client</span><span class=p>.</span><span class=n>clone</span><span class=p>();</span><span class=w>        </span><span class=c1>// å…‹éš†HTTPå®¢æˆ·ç«¯
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>config</span><span class=p>.</span><span class=n>clone</span><span class=p>();</span><span class=w>        </span><span class=c1>// å…‹éš†è¯·æ±‚é…ç½®
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>results</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Arc</span>::<span class=n>clone</span><span class=p>(</span><span class=o>&amp;</span><span class=n>results</span><span class=p>);</span><span class=w> </span><span class=c1>// å…‹éš†å…±äº«ç»“æœçš„å¼•ç”¨
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ä¸ºæ¯ä¸ªå·¥ä½œè€…åˆ›å»ºç‹¬ç«‹çš„é€Ÿç‡é™åˆ¶å™¨
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>rate_limiter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rate</span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>rps</span><span class=o>|</span><span class=w> </span><span class=n>RateLimiter</span>::<span class=n>new</span><span class=p>(</span><span class=n>rps</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>concurrency</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>u64</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ç”Ÿæˆå¼‚æ­¥ä»»åŠ¡
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>handle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tokio</span>::<span class=n>spawn</span><span class=p>(</span><span class=k>async</span><span class=w> </span><span class=k>move</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>run_worker</span><span class=p>(</span><span class=n>client</span><span class=p>,</span><span class=w> </span><span class=n>config</span><span class=p>,</span><span class=w> </span><span class=n>results</span><span class=p>,</span><span class=w> </span><span class=n>rate_limiter</span><span class=p>).</span><span class=k>await</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>handles</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>handle</span><span class=p>);</span><span class=w>  </span><span class=c1>// ä¿å­˜ä»»åŠ¡å¥æŸ„ä»¥ä¾¿åç»­æ§åˆ¶
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>é€Ÿç‡é™åˆ¶åˆ†é…çš„é‡è¦ç»†èŠ‚</strong>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=c1>// å¦‚æœæ€»é€Ÿç‡æ˜¯1000 RPSï¼Œ10ä¸ªå¹¶å‘å·¥ä½œè€…
</span></span></span><span class=line><span class=cl><span class=n>rate</span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>rps</span><span class=o>|</span><span class=w> </span><span class=n>RateLimiter</span>::<span class=n>new</span><span class=p>(</span><span class=n>rps</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>concurrency</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=kt>u64</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>// æ¯ä¸ªå·¥ä½œè€…å¾—åˆ°ï¼š1000 / 10 = 100 RPS
</span></span></span></code></pre></td></tr></table></div></div><h4 id=4-æ—¶é—´æ§åˆ¶å’Œæ¸…ç†>4. æ—¶é—´æ§åˆ¶å’Œæ¸…ç†</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=c1>// è®©æµ‹è¯•è¿è¡ŒæŒ‡å®šçš„æ—¶é—´
</span></span></span><span class=line><span class=cl><span class=n>sleep</span><span class=p>(</span><span class=n>test_duration</span><span class=p>).</span><span class=k>await</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>// æ—¶é—´åˆ°äº†ï¼Œå¼ºåˆ¶åœæ­¢æ‰€æœ‰å·¥ä½œè€…
</span></span></span><span class=line><span class=cl><span class=k>for</span><span class=w> </span><span class=n>handle</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>handles</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>handle</span><span class=p>.</span><span class=n>abort</span><span class=p>();</span><span class=w>  </span><span class=c1>// ä¸­æ­¢å¼‚æ­¥ä»»åŠ¡
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>ä¸ºä»€ä¹ˆç”¨ <code>abort()</code> è€Œä¸æ˜¯ä¼˜é›…å…³é—­ï¼Ÿ</strong></p><ul><li>å‹åŠ›æµ‹è¯•éœ€è¦ç²¾ç¡®çš„æ—¶é—´æ§åˆ¶</li><li>ä¼˜é›…å…³é—­å¯èƒ½ä¼šå»¶é•¿æµ‹è¯•æ—¶é—´</li><li><code>abort()</code> ç¡®ä¿ç«‹å³åœæ­¢</li></ul><h4 id=5-ç»“æœæ”¶é›†å’Œè¾“å‡º>5. ç»“æœæ”¶é›†å’Œè¾“å‡º</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=n>pb</span><span class=p>.</span><span class=n>finish_with_message</span><span class=p>(</span><span class=s>&#34;Test completed&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>// è·å–æœ€ç»ˆç»“æœå¹¶æ‰“å°
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>final_results</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>results</span><span class=p>.</span><span class=n>lock</span><span class=p>().</span><span class=k>await</span><span class=p>;</span><span class=w>  </span><span class=c1>// è·å–äº’æ–¥é”
</span></span></span><span class=line><span class=cl><span class=n>final_results</span><span class=p>.</span><span class=n>print_results</span><span class=p>(</span><span class=n>test_duration</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=n>output</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=å¹¶å‘æ‰§è¡Œæµç¨‹å›¾>å¹¶å‘æ‰§è¡Œæµç¨‹å›¾</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ä¸»çº¿ç¨‹                     å·¥ä½œçº¿ç¨‹1            å·¥ä½œçº¿ç¨‹2            å·¥ä½œçº¿ç¨‹N
</span></span><span class=line><span class=cl>  |                          |                    |                    |
</span></span><span class=line><span class=cl>  â”œâ”€ åˆ›å»ºé…ç½®å’Œå®¢æˆ·ç«¯         |                    |                    |
</span></span><span class=line><span class=cl>  â”œâ”€ åˆ›å»ºå…±äº«ç»“æœå¯¹è±¡         |                    |                    |
</span></span><span class=line><span class=cl>  â”œâ”€ spawnå·¥ä½œçº¿ç¨‹1 â”€â”€â”€â”€â”€â”€â”€â”€â†’ å¼€å§‹å‘é€è¯·æ±‚          |                    |
</span></span><span class=line><span class=cl>  â”œâ”€ spawnå·¥ä½œçº¿ç¨‹2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ å¼€å§‹å‘é€è¯·æ±‚          |
</span></span><span class=line><span class=cl>  â”œâ”€ spawnå·¥ä½œçº¿ç¨‹N â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ å¼€å§‹å‘é€è¯·æ±‚
</span></span><span class=line><span class=cl>  â”œâ”€ sleep(duration)         â”‚                    â”‚                    â”‚
</span></span><span class=line><span class=cl>  â”‚                         â”‚ æŒç»­å‘é€HTTPè¯·æ±‚    â”‚ æŒç»­å‘é€HTTPè¯·æ±‚    â”‚ æŒç»­å‘é€HTTPè¯·æ±‚
</span></span><span class=line><span class=cl>  â”‚                         â”‚ æ›´æ–°å…±äº«ç»“æœ        â”‚ æ›´æ–°å…±äº«ç»“æœ        â”‚ æ›´æ–°å…±äº«ç»“æœ
</span></span><span class=line><span class=cl>  â”œâ”€ æ—¶é—´åˆ°ï¼Œabortæ‰€æœ‰ä»»åŠ¡ â”€â”€â”€â†’ è¢«å¼ºåˆ¶åœæ­¢          â”‚                    â”‚
</span></span><span class=line><span class=cl>  â”œâ”€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ è¢«å¼ºåˆ¶åœæ­¢          â”‚
</span></span><span class=line><span class=cl>  â”œâ”€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ è¢«å¼ºåˆ¶åœæ­¢
</span></span><span class=line><span class=cl>  â”œâ”€ æ”¶é›†ç»“æœ
</span></span><span class=line><span class=cl>  â””â”€ æ‰“å°ç»Ÿè®¡ä¿¡æ¯
</span></span></code></pre></td></tr></table></div></div><h3 id=å†…å­˜å®‰å…¨å’Œå¹¶å‘å®‰å…¨>å†…å­˜å®‰å…¨å’Œå¹¶å‘å®‰å…¨</h3><h4 id=rust-çš„ä¼˜åŠ¿>Rust çš„ä¼˜åŠ¿ï¼š</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=c1>// ç¼–è¯‘æ—¶ä¿è¯çº¿ç¨‹å®‰å…¨
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>results</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Arc</span>::<span class=n>new</span><span class=p>(</span><span class=n>Mutex</span>::<span class=n>new</span><span class=p>(</span><span class=n>TestResult</span>::<span class=n>new</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>results_clone</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Arc</span>::<span class=n>clone</span><span class=p>(</span><span class=o>&amp;</span><span class=n>results</span><span class=p>);</span><span class=w>  </span><span class=c1>// å®‰å…¨çš„å…±äº«
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>// åœ¨å·¥ä½œçº¿ç¨‹ä¸­å®‰å…¨åœ°æ›´æ–°ç»“æœ
</span></span></span><span class=line><span class=cl><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>results</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>results</span><span class=p>.</span><span class=n>lock</span><span class=p>().</span><span class=k>await</span><span class=p>;</span><span class=w>  </span><span class=c1>// è·å–é”
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>results</span><span class=p>.</span><span class=n>add_request</span><span class=p>(</span><span class=n>latency</span><span class=p>,</span><span class=w> </span><span class=n>status</span><span class=p>,</span><span class=w> </span><span class=n>error</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>  </span><span class=c1>// é”è‡ªåŠ¨é‡Šæ”¾
</span></span></span></code></pre></td></tr></table></div></div><h4 id=å¯¹æ¯”å…¶ä»–è¯­è¨€å¯èƒ½çš„é—®é¢˜>å¯¹æ¯”å…¶ä»–è¯­è¨€å¯èƒ½çš„é—®é¢˜ï¼š</h4><ul><li><strong>C/C++</strong>ï¼šå¯èƒ½çš„å†…å­˜æ³„æ¼å’Œæ•°æ®ç«äº‰</li><li><strong>Java</strong>ï¼šéœ€è¦æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹æ± å’ŒåŒæ­¥</li><li><strong>Go</strong>ï¼šéœ€è¦æ˜¾å¼çš„ channel é€šä¿¡æˆ–é”ç®¡ç†</li></ul><h3 id=é”™è¯¯å¤„ç†>é”™è¯¯å¤„ç†</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=c1>// ? æ“ä½œç¬¦å®ç°é“¾å¼é”™è¯¯ä¼ æ’­
</span></span></span><span class=line><span class=cl><span class=kd>let</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestConfig</span>::<span class=n>new</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=w> </span><span class=n>method</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>,</span><span class=w> </span><span class=n>headers</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>//                                                        â†‘
</span></span></span><span class=line><span class=cl><span class=c1>//                                         å¦‚æœå‡ºé”™ï¼Œç«‹å³è¿”å›é”™è¯¯
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>final_results</span><span class=p>.</span><span class=n>print_results</span><span class=p>(</span><span class=n>test_duration</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=n>output</span><span class=p>)</span><span class=o>?</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>//                                                 â†‘
</span></span></span><span class=line><span class=cl><span class=c1>//                                    æ‰“å°å‡ºé”™ä¹Ÿä¼šä¼ æ’­é”™è¯¯
</span></span></span></code></pre></td></tr></table></div></div><p>è¿™ä¸ªå‡½æ•°å±•ç°äº† Rust å¼‚æ­¥ç¼–ç¨‹çš„å¼ºå¤§ï¼š<strong>é›¶æˆæœ¬æŠ½è±¡</strong>ã€<strong>å†…å­˜å®‰å…¨</strong>ã€<strong>å¹¶å‘å®‰å…¨</strong>ï¼ŒåŒæ—¶ä¿æŒé«˜æ€§èƒ½ï¼</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 ä¹™é†‡çš„åšå®¢</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=zh.ethanhan.cc/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>